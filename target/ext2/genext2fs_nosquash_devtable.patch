--- genext2fs-1.3/genext2fs.c~	2005-02-15 02:21:18.000000000 -0700
+++ genext2fs-1.3/genext2fs.c	2005-02-15 02:17:09.000000000 -0700
@@ -1302,6 +1302,8 @@
 	{
 		mode = uid = gid = major = minor = 0;
 		start = 0; increment = 1; count = 0;
+		uid = gid = 0;
+		mode &= ~(FM_IRWXG | FM_IRWXO);
 		lineno++;
 		if((c = strchr(line, '#')))
 			*c = 0;
@@ -1322,10 +1324,6 @@
 		}
 		else
 		{
-			if(squash_uids)
-				uid = gid = 0;
-			if(squash_perms)
-				mode &= ~(FM_IRWXG | FM_IRWXO);
 			mode &= FM_IMASK;
 			path2 = strdup(path);
 			name = basename(path);
