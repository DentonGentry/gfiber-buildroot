#!/usr/bin/python

"""Redirects all HTTP requests to the specified URL."""

import optparse
import sys
import tornado.ioloop
import tornado.web


class Redirector(tornado.web.RequestHandler):

  def initialize(self, url):
    self._url = url

  def get(self):
    self.redirect(self._url)


if __name__ == '__main__':
  parser = optparse.OptionParser()
  parser.add_option('-p', '--port', type='int')
  parser.add_option('-u', '--url', type='string')
  options, args = parser.parse_args(sys.argv)

  if not options.port or not options.url:
    sys.stderr.write('port and url are required\n')
    sys.exit(1)

  application = tornado.web.Application([
      (r'.*', Redirector, dict(url=options.url)),
  ])
  application.listen(options.port)
  tornado.ioloop.IOLoop.instance().start()
