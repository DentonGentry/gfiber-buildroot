QUANTENNA_DRIVERS_SITE=repo://vendor/quantenna/drivers
QUANTENNA_DRIVERS_DEPENDENCIES=linux

ifeq ($(BR2_PACKAGE_QUANTENNA_DRIVERS_PCIE_HOST),y)

define QUANTENNA_DRIVERS_BUILD_CMDS
	$(MAKE) -C $(LINUX_DIR) M=$(@D)/pcie2/host/arm ARCH=$(KERNEL_ARCH) CROSS_COMPILE=$(TARGET_CROSS) modules
endef

define QUANTENNA_DRIVERS_INSTALL_TARGET_CMDS
	$(MAKE) -C $(LINUX_DIR) M=$(@D)/pcie2/host/arm ARCH=$(KERNEL_ARCH) INSTALL_MOD_PATH=$(TARGET_DIR) modules_install
endef

else ifeq ($(or $(BR2_PACKAGE_QUANTENNA_DRIVERS_PCIE_MODULE),$(BR2_PACKAGE_QUANTENNA_DRIVERS_STANDALONE)),y)

ifeq ($(BR2_PACKAGE_QUANTENNA_DRIVERS_PCIE_MODULE),y)
QUANTENNA_DRIVERS_BINARIES_DIR=binaries_pcie_module
else ifeq ($(BR2_PACKAGE_QUANTENNA_DRIVERS_STANDALONE),y)
QUANTENNA_DRIVERS_BINARIES_DIR=binaries_standalone
endif

define QUANTENNA_DRIVERS_BUILD_CMDS
	$(MAKE) -C $(LINUX_DIR) M=$(@D) ARCH=$(KERNEL_ARCH) CROSS_COMPILE=$(TARGET_CROSS) modules
endef

define QUANTENNA_DRIVERS_INSTALL_TARGET_CMDS
	cp -a $(@D)/$(QUANTENNA_DRIVERS_BINARIES_DIR)/* $(TARGET_DIR)
	$(MAKE) -C $(LINUX_DIR) M=$(@D) ARCH=$(KERNEL_ARCH) INSTALL_MOD_PATH=$(TARGET_DIR) modules_install
endef

endif

$(eval $(call GENTARGETS))
