#!/bin/sh

RETVAL=0
PLATFORM=`cat /sys/devices/platform/brcmstb/platform_name | tr a-z A-Z`

start() {
  cd /app/sage
  if [ "$PLATFORM" = "GFHD100" ]; then
    ./runsageclient &
  else
    ./runsage &
  fi
  return $RETVAL
}

stop() {
  /bin/kill `/bin/pidof cvm`
  /bin/kill `/bin/pidof sagesrv`
  return $RETVAL
}

restart() {
  stop
  start
}

case "$1" in
  start)
    start
  ;;
  stop)
    stop
  ;;
  restart)
    restart
  ;;
  *)
  echo "Usage: $0 {start|stop|restart}"
  exit 1
esac

exit $?
